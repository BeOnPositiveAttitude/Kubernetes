Network Namespaces используются контейнерами, такими как Docker, для обеспечения сетевой изоляции.

Начнем с простого хоста. Как мы уже знаем, контейнеры отделены от основного хоста с помощью namespaces.

Что такое namespaces? Если представить, что хост - это дом, то namespace - это отдельная комната в доме, которую вы выделили каждому ребенку. Комнаты помогают обеспечить уединение для каждого ребенка. Каждый ребенок может видеть только то, что находится в его комнате и не может видеть, что происходит вне его комнаты. По их мнению, они единственные, кто живет в доме. Однако вы, как родитель, имеете обзор во все комнаты, а также и в другие пространства дома. Если вы захотите, то сможете установить соединение между двумя комнатами в доме.

Когда вы создаете контейнер, то хотите убедиться, что он изолирован и не видит каких-либо процессов хоста или другого контейнера. Поэтому мы создаем для него специальную "комнату" на хосте с помощью namespace.

Что касается контейнера, то он видит только запущенные им процессы и думает, что находится на своем собственном хосте. Однако основной хост видит вообще все процессы, включая процессы, запущенные внутри контейнеров. Когда вы делаете листинг процессов в контейнере, то видите один единственный процесс с PID равным 1. Когда вы делаете листинг тех же процессов на основном хосте из под пользователя root, то видите вообще все процессы, включая процесс запущенный в контейнере, но в этот раз уже с другим PID. Это один и тот же процесс, но с разным PID внутри и во вне контейнера.

<img src="image.png" width="800" height="300"><br>

Наш хост имеет свои собственные интерфейсы, подключенные к локальной сети, а также свои собственные таблицу маршрутизации и таблицу ARP, содержащие информацию об остальной части сети. Мы хотим "запечатать" (seal) всю эту информацию от контейнера. Когда контейнер создается, мы создаем для него network namespace. Таким образом он не видит какой-либо network-related информации на хосте.