Не будем пока рассматривать зависимые внешние компоненты, такие как ETCD и CoreDNS, а сосредоточимся на core control plane компонентах. Они необязательно должны быть одинаковой версии, их версии могут различаться.

Т.к. kube-apiserver является главным компонентом control plane и другие компоненты обращаются к нему, то ни один из них НЕ может иметь версию выше, чем у kube-apiserver. Controller-manager и kube-scheduler могут быть на одну версию ниже, а kubelet и kube-proxy могут быть на две версии ниже, чем kube-apiserver.

Исключением является утилита kubectl, она может быть как на одну версию выше, так и на одну версию ниже, чем kube-apiserver.

<img src="image.png" width="800" height="300"><br>

Такой допустимый перекос в версиях позволяет нам выполнять live upgrade. Мы можем обновлять компонент за компонентом, если требуется.

K8s в любой момент поддерживает только последние три minor версии. Например, если последний выпущенный релиз 1.12, тогда K8s поддерживает версии 1.12, 1.11 и 1.10.

Можем ли обновиться например сразу с релиза 1.10 до 1.13? Нет. Рекомендуемый подход - обновлять одну minor версию за раз, с 1.10 до 1.11, с 1.11 до 1.12, с 1.12 до 1.13.

<img src="image-1.png" width="300" height="400"><br>

Процесс обновления зависит от того каким образом был развернут ваш кластер. Если ваш кластер является managed K8s кластером, развернутым в одном из облачных провайдеров, то процесс обновления выполняется всего в несколько кликов. Если вы разворачивали кластер с помощью инструмента kubeadm, то он может помочь спланировать обновление кластера - `kubeadm upgrade plan` и `kubeadm upgrade apply`.

Если вы разворачивали кластер с нуля ("The hard way"), тогда придется вручную обновлять различные компоненты кластера.