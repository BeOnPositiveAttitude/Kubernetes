В данном уроке мы рассмотрим как K8s реализует DNS в кластере.

Предположим у нас есть два pod-а с IP-адресами. Как бы действовали мы? Основываясь на том, что мы изучили в prerequisite лекции про DNS, легкий способ дать им возможность разрешать имена друг друга - добавить соответствующую запись в каждый из файлов `/etc/hosts`.

<img src="image.png" width="700" height="200"><br>

Конечно, когда у вас тысячи pod-ов в кластере и сотни из них создаются и удаляются каждую минуту, это решение не подойдет. Поэтому мы перенесем записи в центральный DNS-сервер, а затем укажем pod-ам на этот DNS-сервер путем добавления записи в их файлы `/etc/resolv.conf`, в которой определим, что nameserver имеет IP-адрес DNS-сервера, в нашем примере `10.96.0.10`. Каждый раз, когда создается новый pod, мы добавляем запись на DNS-сервер для этого pod-а, чтобы другие pod-ы могли получить доступ к новому pod-у, и конфигурируем файл `/etc/resolv.conf` pod-а, указывая на DNS-сервер, чтобы новый pod мог разрешать имена других pod-ов в кластере. Это способ, реализованный в K8s. За исключением того, что он не создает подобные записи для pod-ов, чтобы смапить имя pod-а с его IP-адресом, как мы узнали из предыдущей лекции. Он делает это для Services. Для pod-ов K8s формирует hostnames, заменяя точки в IP-адресе pod-а на тире. K8s реализует DNS таким же образом. Он разворачивает DNS-сервер в кластере. До версии v1.12