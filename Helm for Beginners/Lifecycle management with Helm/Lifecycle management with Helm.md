Каждый раз когда мы скачиваем и устанавливаем Chart, создается новый Release. Release чем-то похож на приложение, а точнее представляет из себя коллекцию объектов K8s. Так как Helm знает какие объекты K8s относятся к каждому Release, он может выполнять такие операции, как upgrades, downgrades, uninstall без воздействия на объекты K8s, относящиеся к другим Releases. Каждый Release может управляться независимо от других, даже если все они основаны на одном и том же Chart.

Например мы установили Nginx достаточно старой версии: `helm install nginx-release bitnami/nginx --version 12.0.1`. Затем, спустя два месяца, в этой версии обнаружилось множество уязвимостей и потребовалось обновление. Наш Nginx сайт может содержать большое количество объектов в K8s. Когда мы обновляем pod-ы с Nginx, вероятно понадобится внести некоторые изменения и в другие объекты K8s. Например свежая версия Nginx может потребовать установки новой Environment Variable или создания нового Secret, что повлечет изменение конфигурации объектов K8s. Это может быть довольно сложно - отслеживать все компоненты, которые необходимо изменить. К счастью Helm берет на себя эту задачу и отслеживает все, что связано с Release, и нам не нужно обновлять объекты K8s по одному. Helm может обновить их все всего одной командой: `helm upgrade nginx-release bitnami/nginx`. Будет создана новая Revision. Это и есть Lifecycle management.

Пример из лабы: `helm upgrade dazzling-web bitnami/nginx --version 13`.

Смотреть детальную информацию о конкретном Release: `helm history nginx-release`.

Предположим нам нужно откатиться на самую первую Revision. Это можно сделать одной командой: `helm rollback nginx-release 1`. Helm откатит конфигурацию на ту, что была в Revision 1, но фактически будет создана новая Revision 3.

Nginx - довольно простой пример для обновления. Но существуют и более сложные приложения, которые требуют дополнительных действий для обновления. Например, если мы попробуем обновить WordPress, то получим несколько ошибок, т.к. Helm не сможет обновить все компоненты, не имея текущего пароля администратора БД и самого сайта WP. Их нужно будет задать при обновлении через опции командной строки.

Rollbacks схожи с восстановлением из бэкапа. Они не охватывают файлы и данные, созданные нашим приложением. Вместо этого Helm восстанавливает manifest-файлы наших объектов K8s. Если что-то использует Persistent Volume или другие варианты Persisten Storage или внешние БД, rollback не восстановит эти данные. Например, если мы делаем rollback для pod-ов с MySQL, то сами pod-ы будут восстановлены на предыдущее состояние (версия MySQL и т.д.), но сами данные хранящиеся в БД останутся в неизменном виде.

Существуют варианты, чтобы сделать consistent backup БД перед обновлением Charts и даже для rollback БД, но это делается с помощью Chart Hooks, которые будут рассмотрены далее в этом курсе.